<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Wx client</title>
    <link rel="stylesheet" href="public/bootstrap.min.css">
    <style>
        .well {
            margin-left:20px;
            margin-right:20px;
        }
        .well img{
            width:60px;
            margin-right:15px;
        }
    </style>
</head>
<body>
<div id="msg">
    <div style="text-align: center;">
        <h3 style="color: #ac2925;">微信墙</h3>
    </div>
    <div class="well">
        <table>
            <tr>
                <td>
                    <img src="http://wx.qlogo.cn/mmopen/LdL5tuia2rkziaSR3PB0khvicyEIdNVHzUL0NFcAkavIibIokia9ibwCia744unz7VlsM6rIus50LrILaWM3dCoIePbCPusI19zGF3w/0">
                </td>
                <td>
                    2016年5月28日15:20 &nbsp;&nbsp;
                </td>
                <td style="text-align: center;color: #660000">
                        柳橙雪梨ssssssss
                </td>
                <td>
                    说：大家好
                </td>
            </tr>
        </table>
    </div>
    <div class="well">
        <table>
            <tr>
                <td>
                    <img src="http://wx.qlogo.cn/mmopen/LdL5tuia2rkziaSR3PB0khvicyEIdNVHzUL0NFcAkavIibIokia9ibwCia744unz7VlsM6rIus50LrILaWM3dCoIePbCPusI19zGF3w/0">
                </td>
                <td>
                    2016年5月28日 15:20
                </td>
                <td style="text-align: center;color: #660000">
                    柳橙雪梨ssssssss
                </td>
                <td>
                    说：大家好
                </td>
            </tr>
        </table>
    </div>
</div>
<script src="public/socket.io/socket.io.js"></script>
<script src="http://code.jquery.com/jquery-1.11.1.js"></script>
<script type="text/javascript">

    var socket = io();
    var msglist = document.getElementById('msg');
    socket.on('chat message', function(data) {
        var msg = JSON.parse(data);
        var content = msg.xml.Content[0];
        var create_time = msg.xml.CreateTime[0];
        var date = new Date(create_time);
        var theDate = date.toLocaleString();
        console.log(theDate);

        msg.user = msg.user || {};
        var userName = msg.user.nickname;
        var headimg = msg.user.headimgurl;

        var ele_div = document.createElement('div');
        ele_div.className = 'well';
        var ele_table = document.createElement('table');
        var ele_tr = document.createElement('tr');

        var ele_td_img = document.createElement('td');
        ele_td_img.innerHTML = '<img src="' + headimg + '">';
        var ele_td_time = document.createElement('td');
        ele_td_time.innerHTML = '2016年5月28日15:20 &nbsp;&nbsp;';
        var ele_td_user = document.createElement('td');
        ele_td_user.innerHTML = ''+userName;
        var ele_td_word = document.createElement('td');
        ele_td_word.innerHTML = '说：'+content;

//        ele_div.innerHTML = '<img src="' + headimg + '">' + '说：' + content;
        ele_tr.appendChild(ele_td_img);
        ele_tr.appendChild(ele_td_time);
        ele_tr.appendChild(ele_td_user);
        ele_tr.appendChild(ele_td_word);
        ele_table.appendChild(ele_tr);
        ele_div.appendChild(ele_table);
        msglist.appendChild(ele_div);
//        $('#messages').append($('<li>').text(msg.xml.Content[0]));
//        $('#messages').append($('<li>').text(msg.user.nickname));
    });


</script>
</body>
</html>